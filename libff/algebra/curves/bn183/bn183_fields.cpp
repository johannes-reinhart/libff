/** @file
 *****************************************************************************
 * @author     This file is part of libff, developed by SCIPR Lab
 *             and contributors (see AUTHORS).
 * @copyright  MIT license (see LICENSE file)
 *****************************************************************************/

#include <libff/algebra/curves/bn183/bn183_fields.hpp>

namespace libff {

bigint<bn183_r_limbs> bn183_modulus_r;
bigint<bn183_q_limbs> bn183_modulus_q;

void init_bn183_fields()
{
    using bigint_r = bigint<bn183_r_limbs>;
    using bigint_q = bigint<bn183_q_limbs>;

    assert(sizeof(mp_limb_t) == 8 || sizeof(mp_limb_t) == 4); // Montgomery assumes this

    /* parameters for scalar field Fr */

    bn183_modulus_r = bigint_r("6804759748846355405830582786011032970784946075266449409");
	assert(bn183_Fr::modulus_is_valid());
	if (sizeof(mp_limb_t) == 8)
	{
		bn183_Fr::Rsquared = bigint_r("4801522710881280585271926064454638513131292201709055404");
		bn183_Fr::Rcubed = bigint_r("2350825622886050112586081822662505719285622719951620976");
		bn183_Fr::inv = 0xd190d3bfbfffffff;
	}
	if (sizeof(mp_limb_t) == 4)
	{
	    bn183_Fr::Rsquared = bigint_r("4801522710881280585271926064454638513131292201709055404");
	    bn183_Fr::Rcubed = bigint_r("2350825622886050112586081822662505719285622719951620976");
	    bn183_Fr::inv = 0xbfffffff;
	}
	bn183_Fr::num_bits = 183;
	bn183_Fr::euler = bigint_r("3402379874423177702915291393005516485392473037633224704");
	bn183_Fr::s = 30;
	bn183_Fr::t = bigint_r("6337426368935364676481655599559687982113050367");
	bn183_Fr::t_minus_1_over_2 = bigint_r("3168713184467682338240827799779843991056525183");
	bn183_Fr::multiplicative_generator = bn183_Fr("22");
	bn183_Fr::root_of_unity = bn183_Fr("2623669254730310979327427666220599232295120028155085950");
	bn183_Fr::nqr = bn183_Fr("11");
	bn183_Fr::nqr_to_t = bn183_Fr("2525840099987162180634638061660122563958686325286076947");

    /* parameters for base field Fq */

    bn183_modulus_q = bigint_q("6804759748846355405830582788619626413398422602255236423");
	assert(bn183_Fq::modulus_is_valid());
	if (sizeof(mp_limb_t) == 8)
	{
		bn183_Fq::Rsquared = bigint_q("4625922277762163815253248537926360504155082597423953257");
		bn183_Fq::Rcubed = bigint_q("2622606892187472848846473801166772541043934045684484273");
		bn183_Fq::inv = 0x10ca29554866389;
	}
	if (sizeof(mp_limb_t) == 4)
	{
        bn183_Fq::Rsquared = bigint_q("4625922277762163815253248537926360504155082597423953257");
        bn183_Fq::Rcubed = bigint_q("2622606892187472848846473801166772541043934045684484273");
        bn183_Fq::inv = 0x54866389;
	}
	bn183_Fq::num_bits = 183;
	bn183_Fq::euler = bigint_q("3402379874423177702915291394309813206699211301127618211");
	bn183_Fq::s = 1;
	bn183_Fq::t = bigint_q("3402379874423177702915291394309813206699211301127618211");
	bn183_Fq::t_minus_1_over_2 = bigint_q("1701189937211588851457645697154906603349605650563809105");
	bn183_Fq::multiplicative_generator = bn183_Fq("6");
	bn183_Fq::root_of_unity = bn183_Fq("6804759748846355405830582788619626413398422602255236422");
	bn183_Fq::nqr = bn183_Fq("3");
	bn183_Fq::nqr_to_t = bn183_Fq("6804759748846355405830582788619626413398422602255236422");

    /* parameters for twist field Fq2 */

 	bn183_Fq2::euler = bigint<2*bn183_q_limbs>("23152377619759756950456313003869751545984321198955943727497656786032782123287395464244357860809405461812917464");
	bn183_Fq2::s = 4;
	bn183_Fq2::t = bigint<2*bn183_q_limbs>("2894047202469969618807039125483718943248040149869492965937207098254097765410924433030544732601175682726614683");
	bn183_Fq2::t_minus_1_over_2 = bigint<2*bn183_q_limbs>("1447023601234984809403519562741859471624020074934746482968603549127048882705462216515272366300587841363307341");
	bn183_Fq2::non_residue = bn183_Fq("6804759748846355405830582788619626413398422602255236422");
	bn183_Fq2::nqr = bn183_Fq2(bn183_Fq("2"),bn183_Fq("1"));
	bn183_Fq2::nqr_to_t = bn183_Fq2(bn183_Fq("5239020965882544171951588859755227070855136523793989209"),bn183_Fq("2083078949678301983706857327602169627328137735904740868"));
	bn183_Fq2::Frobenius_coeffs_c1[0] = bn183_Fq("1");
	bn183_Fq2::Frobenius_coeffs_c1[1] = bn183_Fq("6804759748846355405830582788619626413398422602255236422");

    /* parameters for Fq6 */

    bn183_Fq6::euler = bigint<6*bn183_q_limbs>("49641715709586579157436000244113138012099128475922397721029798952305741727320190413962044573100544233834848043779162235018632139874059357264853331617749815113046511258440200049813368427808390636113984753907650281785408474290064865798544539603523864969218137470703948583647467240904109027297421970837192894226581605366804788673544");
    bn183_Fq6::s = 4;
    bn183_Fq6::t = bigint<6*bn183_q_limbs>("6205214463698322394679500030514142251512391059490299715128724869038217715915023801745255571637568029229356005472395279377329017484257419658106666452218726889130813907305025006226671053476048829514248094238456285223176059286258108224818067450440483121152267183837993572955933405113013628412177746354649111778322700670850598584193");
    bn183_Fq6::t_minus_1_over_2 = bigint<6*bn183_q_limbs>("3102607231849161197339750015257071125756195529745149857564362434519108857957511900872627785818784014614678002736197639688664508742128709829053333226109363444565406953652512503113335526738024414757124047119228142611588029643129054112409033725220241560576133591918996786477966702556506814206088873177324555889161350335425299292096");
	bn183_Fq6::non_residue = bn183_Fq2(bn183_Fq("2"),bn183_Fq("1"));
    bn183_Fq6::nqr = bn183_Fq6(bn183_Fq2(bn183_Fq("1"),bn183_Fq("0")),
                                                 bn183_Fq2(bn183_Fq("1"),bn183_Fq("0")),
                                                 bn183_Fq2::zero());
    bn183_Fq6::nqr_to_t = bn183_Fq6(bn183_Fq2(bn183_Fq("1565738782963811233878993928864399342543286078461247214"),bn183_Fq("4721680799168053422123725461017456786070284866350495555")),
                                            bn183_Fq2::zero(),bn183_Fq2::zero());
	bn183_Fq6::Frobenius_coeffs_c1[0] = bn183_Fq2(bn183_Fq("1"),bn183_Fq("0"));
	bn183_Fq6::Frobenius_coeffs_c1[1] = bn183_Fq2(bn183_Fq("2514746150702782023387381073984499065469793711673933027"),bn183_Fq("3170995372818140140778075409082321578161037698420449167"));
	bn183_Fq6::Frobenius_coeffs_c1[2] = bn183_Fq2(bn183_Fq("6804759748846192230227353928539493912877092911468838216"),bn183_Fq("0"));
	bn183_Fq6::Frobenius_coeffs_c1[3] = bn183_Fq2(bn183_Fq("4061635512342874448491275083422895020036595348657332181"),bn183_Fq("3678589620058485595545610840157249645173639502032583691"));
	bn183_Fq6::Frobenius_coeffs_c1[4] = bn183_Fq2(bn183_Fq("163175603228860080132500521329690786398206"),bn183_Fq("0"));
	bn183_Fq6::Frobenius_coeffs_c1[5] = bn183_Fq2(bn183_Fq("228378085800698933951926631212232327892033541923971215"),bn183_Fq("6759934504816085075337479327999681603462168004057439988"));
	bn183_Fq6::Frobenius_coeffs_c2[0] = bn183_Fq2(bn183_Fq("1"),bn183_Fq("0"));
	bn183_Fq6::Frobenius_coeffs_c2[1] = bn183_Fq2(bn183_Fq("172887046704635624765638747223295244684223803712619877"),bn183_Fq("6648952426623958456964903560021807437046548527634737312"));
	bn183_Fq6::Frobenius_coeffs_c2[2] = bn183_Fq2(bn183_Fq("163175603228860080132500521329690786398206"),bn183_Fq("0"));
	bn183_Fq6::Frobenius_coeffs_c2[3] = bn183_Fq2(bn183_Fq("2216013510897478354990509493375787861242414648470426925"),bn183_Fq("6792105366014048814374662448682661740983700703914009602"));
	bn183_Fq6::Frobenius_coeffs_c2[4] = bn183_Fq2(bn183_Fq("6804759748846192230227353928539493912877092911468838216"),bn183_Fq("0"));
	bn183_Fq6::Frobenius_coeffs_c2[5] = bn183_Fq2(bn183_Fq("4415859191244241426074434548020543307471784150072189621"),bn183_Fq("168461705054703540321599568534783648766595972961725932"));

    /* parameters for Fq12 */

    bn183_Fq12::euler = bigint<12*bn183_q_limbs>("4928599877182829928459738860137152648034980259770404959054877280931953785277871502322393122682542119057208006993201654985550061335313151874399403175420380800576849327755948595042683578887463750055746333450167446565210573324061011572004467379083794821348741065331201770889787616284569591073675909669678027968990968543405632502496577432611715146025215381942861778356082633774675135277618375332416892918109820867381600538369705915161114364999572473717681898424777926132410249031084882321923359550828076024452091418487128334669008270844126168376403498677456635599118607222954748033372253708936029957135890097826877355166546322509485997573641383377279031588386960");
    bn183_Fq12::s = 5;
    bn183_Fq12::t = bigint<12*bn183_q_limbs>("308037492323926870528733678758572040502186266235650309940929830058247111579866968895149570167658882441075500437075103436596878833457071992149962698463773800036053082984746787190167723680466484378484145840635465410325660832753813223250279211192737176334296316583200110680611726017785599442104744354354876748061935533962852031406036089538232196626575961371428861147255164610917195954851148458276055807381863804211350033648106619697569647812473279607355118651548620383275640564442805145120209971926754751528255713655445520916813016927757885523525218667341039724944912951434671752085765856808501872320993131114179834697909145156842874848352586461079939474274185");
    bn183_Fq12::t_minus_1_over_2 = bigint<12*bn183_q_limbs>("154018746161963435264366839379286020251093133117825154970464915029123555789933484447574785083829441220537750218537551718298439416728535996074981349231886900018026541492373393595083861840233242189242072920317732705162830416376906611625139605596368588167148158291600055340305863008892799721052372177177438374030967766981426015703018044769116098313287980685714430573627582305458597977425574229138027903690931902105675016824053309848784823906236639803677559325774310191637820282221402572560104985963377375764127856827722760458406508463878942761762609333670519862472456475717335876042882928404250936160496565557089917348954572578421437424176293230539969737137092");
	bn183_Fq12::non_residue = bn183_Fq2(bn183_Fq("2"),bn183_Fq("1"));
    bn183_Fq12::nqr = bn183_Fq12(bn183_Fq("2")*bn183_Fq6::one(), bn183_Fq6::one());
    bn183_Fq12::nqr_to_t = bn183_Fq12(bn183_Fq6::zero(),
                                              bn183_Fq6(bn183_Fq2::zero(),bn183_Fq2(bn183_Fq("379931516254153034326843010417362277380798085436226056"),bn183_Fq("1517111806833358817660849861965451310145639805861693521")),bn183_Fq2::zero()));

    bn183_Fq12::Frobenius_coeffs_c1[0] = bn183_Fq2(bn183_Fq("1"),bn183_Fq("0"));
	bn183_Fq12::Frobenius_coeffs_c1[1] = bn183_Fq2(bn183_Fq("4908098401790815454596518091353564426342417331458769898"),bn183_Fq("1177507218167327758058649584930815310446906671643001951"));
	bn183_Fq12::Frobenius_coeffs_c1[2] = bn183_Fq2(bn183_Fq("6804759748846192230227353928539493912877092911468838217"),bn183_Fq("0"));
	bn183_Fq12::Frobenius_coeffs_c1[3] = bn183_Fq2(bn183_Fq("3455354879798393613235475621405159358835317712922723195"),bn183_Fq("2806143698746592880808312773195363860371254692449608907"));
	bn183_Fq12::Frobenius_coeffs_c1[4] = bn183_Fq2(bn183_Fq("6804759748846192230227353928539493912877092911468838216"),bn183_Fq("0"));
	bn183_Fq12::Frobenius_coeffs_c1[5] = bn183_Fq2(bn183_Fq("5352016226853933564469540318671221345891322983719189720"),bn183_Fq("1628636480579265122749663188264548549924348020806606956"));
	bn183_Fq12::Frobenius_coeffs_c1[6] = bn183_Fq2(bn183_Fq("6804759748846355405830582788619626413398422602255236422"),bn183_Fq("0"));
	bn183_Fq12::Frobenius_coeffs_c1[7] = bn183_Fq2(bn183_Fq("1896661347055539951234064697266061987056005270796466525"),bn183_Fq("5627252530679027647771933203688811102951515930612234472"));
	bn183_Fq12::Frobenius_coeffs_c1[8] = bn183_Fq2(bn183_Fq("163175603228860080132500521329690786398206"),bn183_Fq("0"));
	bn183_Fq12::Frobenius_coeffs_c1[9] = bn183_Fq2(bn183_Fq("3349404869047961792595107167214467054563104889332513228"),bn183_Fq("3998616050099762525022270015424262553027167909805627516"));
	bn183_Fq12::Frobenius_coeffs_c1[10] = bn183_Fq2(bn183_Fq("163175603228860080132500521329690786398207"),bn183_Fq("0"));
	bn183_Fq12::Frobenius_coeffs_c1[11] = bn183_Fq2(bn183_Fq("1452743521992421841361042469948405067507099618536046703"),bn183_Fq("5176123268267090283080919600355077863474074581448629467"));


}

} // namespace libff
