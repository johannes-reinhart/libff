/** @file
 *****************************************************************************
 * @author     This file is part of libff, developed by SCIPR Lab
 *             and contributors (see AUTHORS).
 * @copyright  MIT license (see LICENSE file)
 *****************************************************************************/

#include <libff/algebra/curves/bn124/bn124_fields.hpp>

namespace libff {

bigint<bn124_r_limbs> bn124_modulus_r;
bigint<bn124_q_limbs> bn124_modulus_q;

void init_bn124_fields()
{
    using bigint_r = bigint<bn124_r_limbs>;
    using bigint_q = bigint<bn124_q_limbs>;

    assert(sizeof(mp_limb_t) == 8 || sizeof(mp_limb_t) == 4); // Montgomery assumes this

    /* parameters for scalar field Fr */

    bn124_modulus_r = bigint_r("17000133324792832058895897937997463553");
	assert(bn124_Fr::modulus_is_valid());
	if (sizeof(mp_limb_t) == 8)
	{
		bn124_Fr::Rsquared = bigint_r("11418104352409030789881016589005285164");
		bn124_Fr::Rcubed = bigint_r("14736843594676410769816466500475533132");
		bn124_Fr::inv = 0x6f1a7d37f9ffffff;
	}
	if (sizeof(mp_limb_t) == 4)
	{
	    bn124_Fr::Rsquared = bigint_r("11418104352409030789881016589005285164");
	    bn124_Fr::Rcubed = bigint_r("14736843594676410769816466500475533132");
	    bn124_Fr::inv = 0xf9ffffff;
	}
	bn124_Fr::num_bits = 124;
	bn124_Fr::euler = bigint_r("8500066662396416029447948968998731776");
	bn124_Fr::s = 25;
	bn124_Fr::t = bigint_r("506643453979278566208359537661");
	bn124_Fr::t_minus_1_over_2 = bigint_r("253321726989639283104179768830");
	bn124_Fr::multiplicative_generator = bn124_Fr("7");
	bn124_Fr::root_of_unity = bn124_Fr("7041117609370421414184985844533865071");
	bn124_Fr::nqr = bn124_Fr("5");
	bn124_Fr::nqr_to_t = bn124_Fr("5402570782257262925316013050580052157");

    /* parameters for base field Fq */

    bn124_modulus_q = bigint_q("17000133324792832063019019729102503239");
	assert(bn124_Fq::modulus_is_valid());
	if (sizeof(mp_limb_t) == 8)
	{
		bn124_Fq::Rsquared = bigint_q("970922853877366668957860206680662374");
		bn124_Fq::Rcubed = bigint_q("3961631914214792113485504389977106612");
		bn124_Fq::inv = 0x270c4633e2866389;
	}
	if (sizeof(mp_limb_t) == 4)
	{
        bn124_Fq::Rsquared = bigint_q("970922853877366668957860206680662374");
        bn124_Fq::Rcubed = bigint_q("3961631914214792113485504389977106612");
        bn124_Fq::inv = 0xe2866389;
	}
	bn124_Fq::num_bits = 124;
	bn124_Fq::euler = bigint_q("8500066662396416031509509864551251619");
	bn124_Fq::s = 1;
	bn124_Fq::t = bigint_q("8500066662396416031509509864551251619");
	bn124_Fq::t_minus_1_over_2 = bigint_q("4250033331198208015754754932275625809");
	bn124_Fq::multiplicative_generator = bn124_Fq("3");
	bn124_Fq::root_of_unity = bn124_Fq("17000133324792832063019019729102503238");
	bn124_Fq::nqr = bn124_Fq("3");
	bn124_Fq::nqr_to_t = bn124_Fq("17000133324792832063019019729102503238");

    /* parameters for twist field Fq2 */

 	bn124_Fq2::euler = bigint<2*bn124_q_limbs>("144502266530365895263179596682604415360704056092488118361332655688002745560");
	bn124_Fq2::s = 4;
	bn124_Fq2::t = bigint<2*bn124_q_limbs>("18062783316295736907897449585325551920088007011561014795166581961000343195");
	bn124_Fq2::t_minus_1_over_2 = bigint<2*bn124_q_limbs>("9031391658147868453948724792662775960044003505780507397583290980500171597");
	bn124_Fq2::non_residue = bn124_Fq("17000133324792832063019019729102503238");
	bn124_Fq2::nqr = bn124_Fq2(bn124_Fq("4"),bn124_Fq("1"));
	bn124_Fq2::nqr_to_t = bn124_Fq2(bn124_Fq("1825900826507868886575347749084662433"),bn124_Fq("1170046685488032210202010068865199745"));
	bn124_Fq2::Frobenius_coeffs_c1[0] = bn124_Fq("1");
	bn124_Fq2::Frobenius_coeffs_c1[1] = bn124_Fq("17000133324792832063019019729102503238");

    /* parameters for Fq6 */

    bn124_Fq6::euler = bigint<6*bn124_q_limbs>("12069352417555951654720593447950134292350549045810471633502197144080298045297327237481785777658530341573855149620637022544942868946334626074457611350372789189600394298902977891149861958426808930610086265227123657451292982280");
    bn124_Fq6::s = 4;
    bn124_Fq6::t = bigint<6*bn124_q_limbs>("1508669052194493956840074180993766786543818630726308954187774643010037255662165904685223222207316292696731893702579627818117858618291828259307201418796598648700049287362872236393732744803351116326260783153390457181411622785");
    bn124_Fq6::t_minus_1_over_2 = bigint<6*bn124_q_limbs>("754334526097246978420037090496883393271909315363154477093887321505018627831082952342611611103658146348365946851289813909058929309145914129653600709398299324350024643681436118196866372401675558163130391576695228590705811392");
	bn124_Fq6::non_residue = bn124_Fq2(bn124_Fq("5"),bn124_Fq("1"));
    bn124_Fq6::nqr = bn124_Fq6(bn124_Fq2(bn124_Fq("1"),bn124_Fq("0")),
                                                 bn124_Fq2(bn124_Fq("1"),bn124_Fq("0")),
                                                 bn124_Fq2::zero());
    bn124_Fq6::nqr_to_t = bn124_Fq6(bn124_Fq2(bn124_Fq("15830086639304799852817009660237303494"),bn124_Fq("1825900826507868886575347749084662433")),
                                            bn124_Fq2::zero(),bn124_Fq2::zero());
	bn124_Fq6::Frobenius_coeffs_c1[0] = bn124_Fq2(bn124_Fq("1"),bn124_Fq("0"));
	bn124_Fq6::Frobenius_coeffs_c1[1] = bn124_Fq2(bn124_Fq("11057421525851115170548223099100677627"),bn124_Fq("5501413929240230020448532534432497469"));
	bn124_Fq6::Frobenius_coeffs_c1[2] = bn124_Fq2(bn124_Fq("17000133314539031286158302362289896776"),bn124_Fq("0"));
	bn124_Fq6::Frobenius_coeffs_c1[3] = bn124_Fq2(bn124_Fq("8440916522327550324300911988325232958"),bn124_Fq("16037873359284321335114966383032657210"));
	bn124_Fq6::Frobenius_coeffs_c1[4] = bn124_Fq2(bn124_Fq("10253800776860717366812606462"),bn124_Fq("0"));
	bn124_Fq6::Frobenius_coeffs_c1[5] = bn124_Fq2(bn124_Fq("14501928601406998631188904370779095893"),bn124_Fq("12460979361061112770474540540739851799"));
	bn124_Fq6::Frobenius_coeffs_c2[0] = bn124_Fq2(bn124_Fq("1"),bn124_Fq("0"));
	bn124_Fq6::Frobenius_coeffs_c2[1] = bn124_Fq2(bn124_Fq("4670603572092301810218237735257106308"),bn124_Fq("14304754188866124854678266550437413591"));
	bn124_Fq6::Frobenius_coeffs_c2[2] = bn124_Fq2(bn124_Fq("10253800776860717366812606462"),bn124_Fq("0"));
	bn124_Fq6::Frobenius_coeffs_c2[3] = bn124_Fq2(bn124_Fq("4238607547776512410928780877149578148"),bn124_Fq("12026461811321963831273330556256886399"));
	bn124_Fq6::Frobenius_coeffs_c2[4] = bn124_Fq2(bn124_Fq("17000133314539031286158302362289896776"),bn124_Fq("0"));
	bn124_Fq6::Frobenius_coeffs_c2[5] = bn124_Fq2(bn124_Fq("8090922204924017841872001116695818783"),bn124_Fq("7669050649397575440086442351510706488"));

    /* parameters for Fq12 */

    bn124_Fq12::euler = bigint<12*bn124_q_limbs>("291338535558327389569166740447538399977459005061193593093341200827580154938280437020024509662607975494726654997502605620289255863311316297555889545833999812371809419982884176183504489372994799141141277411056870943294666870536648782051356499432837933354467282427559781632553835762019043344579516534075778898114810871392808520720528210661031343055549134883718863729552254569807339539235964883623188422312225984161990928990257793264150865255373961360");
    bn124_Fq12::s = 5;
    bn124_Fq12::t = bigint<12*bn124_q_limbs>("18208658472395461848072921277971149998591187816324599568333825051723759683642527313751531853912998468420415937343912851268078491456957268597243096614624988273238088748930261011469030585812174946321329838191054433955916679408540548878209781214552370834654205151722486352034614735126190209036219783379736181132175679462050532545033013166314458940971820930232428983097015910612958721202247805226449276394514124010124433061891112079009429078460872585");
    bn124_Fq12::t_minus_1_over_2 = bigint<12*bn124_q_limbs>("9104329236197730924036460638985574999295593908162299784166912525861879841821263656875765926956499234210207968671956425634039245728478634298621548307312494136619044374465130505734515292906087473160664919095527216977958339704270274439104890607276185417327102575861243176017307367563095104518109891689868090566087839731025266272516506583157229470485910465116214491548507955306479360601123902613224638197257062005062216530945556039504714539230436292");
	bn124_Fq12::non_residue = bn124_Fq2(bn124_Fq("5"),bn124_Fq("1"));
    bn124_Fq12::nqr = bn124_Fq12(bn124_Fq("1")*bn124_Fq6::one(), bn124_Fq6::one());
    bn124_Fq12::nqr_to_t = bn124_Fq12(bn124_Fq6::zero(),
                                              bn124_Fq6(bn124_Fq2::zero(),bn124_Fq2(bn124_Fq("509064673471024543261998676910962560"),bn124_Fq("217706280099735006870477996062574371")),bn124_Fq2::zero()));

    bn124_Fq12::Frobenius_coeffs_c1[0] = bn124_Fq2(bn124_Fq("1"),bn124_Fq("0"));
	bn124_Fq12::Frobenius_coeffs_c1[1] = bn124_Fq2(bn124_Fq("6060884745197156790398582094782272414"),bn124_Fq("7672369959315728193421712955671707127"));
	bn124_Fq12::Frobenius_coeffs_c1[2] = bn124_Fq2(bn124_Fq("17000133314539031286158302362289896777"),bn124_Fq("0"));
	bn124_Fq12::Frobenius_coeffs_c1[3] = bn124_Fq2(bn124_Fq("6950338899314685341979250055353674380"),bn124_Fq("15804448772966015316831826488521416905"));
	bn124_Fq12::Frobenius_coeffs_c1[4] = bn124_Fq2(bn124_Fq("17000133314539031286158302362289896776"),bn124_Fq("0"));
	bn124_Fq12::Frobenius_coeffs_c1[5] = bn124_Fq2(bn124_Fq("889454154117528551580667960571401966"),bn124_Fq("8132078813650287123410113532849709778"));
	bn124_Fq12::Frobenius_coeffs_c1[6] = bn124_Fq2(bn124_Fq("17000133324792832063019019729102503238"),bn124_Fq("0"));
	bn124_Fq12::Frobenius_coeffs_c1[7] = bn124_Fq2(bn124_Fq("10939248579595675272620437634320230825"),bn124_Fq("9327763365477103869597306773430796112"));
	bn124_Fq12::Frobenius_coeffs_c1[8] = bn124_Fq2(bn124_Fq("10253800776860717366812606462"),bn124_Fq("0"));
	bn124_Fq12::Frobenius_coeffs_c1[9] = bn124_Fq2(bn124_Fq("10049794425478146721039769673748828859"),bn124_Fq("1195684551826816746187193240581086334"));
	bn124_Fq12::Frobenius_coeffs_c1[10] = bn124_Fq2(bn124_Fq("10253800776860717366812606463"),bn124_Fq("0"));
	bn124_Fq12::Frobenius_coeffs_c1[11] = bn124_Fq2(bn124_Fq("16110679170675303511438351768531101273"),bn124_Fq("8868054511142544939608906196252793461"));


}

} // namespace libff
