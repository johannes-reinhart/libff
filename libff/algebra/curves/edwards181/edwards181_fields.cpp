#include <libff/algebra/curves/edwards181/edwards181_fields.hpp>

namespace libff {

bigint<edwards181_r_limbs> edwards181_modulus_r;
bigint<edwards181_q_limbs> edwards181_modulus_q;

void init_edwards181_fields()
{
    using bigint_r = bigint<edwards181_r_limbs>;
    using bigint_q = bigint<edwards181_q_limbs>;

    assert(sizeof(mp_limb_t) == 8 || sizeof(mp_limb_t) == 4); // Montgomery assumes this

    /* parameters for scalar field Fr */

    edwards181_modulus_r = bigint_r("1552511030102430251236801561344621993261920897571225601");
    assert(edwards181_Fr::modulus_is_valid());
    if (sizeof(mp_limb_t) == 8)
    {
        edwards181_Fr::Rsquared = bigint_r("621738487827897760168419760282818735947979812540885779");
        edwards181_Fr::Rcubed = bigint_r("899968968216802386013510389846941393831065658679774050");
        edwards181_Fr::inv = 0xdde553277fffffff;
    }
    if (sizeof(mp_limb_t) == 4)
    {
        edwards181_Fr::Rsquared = bigint_r("621738487827897760168419760282818735947979812540885779");
        edwards181_Fr::Rcubed = bigint_r("899968968216802386013510389846941393831065658679774050");
        edwards181_Fr::inv = 0x7fffffff;
    }
    edwards181_Fr::num_bits = 181;
    edwards181_Fr::euler = bigint_r("776255515051215125618400780672310996630960448785612800");
    edwards181_Fr::s = 31;
    edwards181_Fr::t = bigint_r("722944284836962004768104088187507350585386575");
    edwards181_Fr::t_minus_1_over_2 = bigint_r("361472142418481002384052044093753675292693287");
    edwards181_Fr::multiplicative_generator = edwards181_Fr("19");
    edwards181_Fr::root_of_unity = edwards181_Fr("695314865466598274460565335217615316274564719601897184");
    edwards181_Fr::nqr = edwards181_Fr("11");
    edwards181_Fr::nqr_to_t = edwards181_Fr("1326707053668679463752768729767248251415639579872144553");

    /* parameters for base field Fq */

    edwards181_modulus_q = bigint_q("6210044120409721004947206240885978274523751269793792001");
    assert(edwards181_Fq::modulus_is_valid());
    if (sizeof(mp_limb_t) == 8)
    {
        edwards181_Fq::Rsquared = bigint_q("5943559676554581037560514598978484097352477055348195432");
        edwards181_Fq::Rcubed = bigint_q("1081560488703514202058739223469726982199727506489234349");
        edwards181_Fq::inv = 0x76eb690b7fffffff;
    }
    if (sizeof(mp_limb_t) == 4)
    {
        edwards181_Fq::Rsquared = bigint_q("5943559676554581037560514598978484097352477055348195432");
        edwards181_Fq::Rcubed = bigint_q("1081560488703514202058739223469726982199727506489234349");
        edwards181_Fq::inv = 0x7fffffff;
    }
    edwards181_Fq::num_bits = 183;
    edwards181_Fq::euler = bigint_q("3105022060204860502473603120442989137261875634896896000");
    edwards181_Fq::s = 31;
    edwards181_Fq::t = bigint_q("2891777139347848019072416350658041552884388375");
    edwards181_Fq::t_minus_1_over_2 = bigint_q("1445888569673924009536208175329020776442194187");
    edwards181_Fq::multiplicative_generator = edwards181_Fq("61");
    edwards181_Fq::root_of_unity = edwards181_Fq("4692813029219384139894873043933463717810008194158530536");
    edwards181_Fq::nqr = edwards181_Fq("23");
    edwards181_Fq::nqr_to_t = edwards181_Fq("2626736066325740702418554487368721595489070118548299138");

    /* parameters for twist field Fq3 */

    edwards181_Fq3::euler = bigint<3*edwards181_q_limbs>("119744082713971502962992613191067836698205043373978948903839934564152994858051284658545502971203325031831647424413111161318314144765646525057914792711854057586688000");
    edwards181_Fq3::s = 31;
    edwards181_Fq3::t = bigint<3*edwards181_q_limbs>("111520367408144756185815309352304634357062208814526860512643991563611659089151103662834971185031649686239331424621037357783237607000066456438894190557165125");
    edwards181_Fq3::t_minus_1_over_2 = bigint<3*edwards181_q_limbs>("55760183704072378092907654676152317178531104407263430256321995781805829544575551831417485592515824843119665712310518678891618803500033228219447095278582562");
    edwards181_Fq3::non_residue = edwards181_Fq("61");
    edwards181_Fq3::nqr = edwards181_Fq3(edwards181_Fq("23"),edwards181_Fq("0"),edwards181_Fq("0"));
    edwards181_Fq3::nqr_to_t = edwards181_Fq3(edwards181_Fq("104810943629412208121981114244673004633270996333237516"),edwards181_Fq("0"),edwards181_Fq("0"));
    edwards181_Fq3::Frobenius_coeffs_c1[0] = edwards181_Fq("1");
    edwards181_Fq3::Frobenius_coeffs_c1[1] = edwards181_Fq("1073752683758513276629212192812154536507607213288832061");
    edwards181_Fq3::Frobenius_coeffs_c1[2] = edwards181_Fq("5136291436651207728317994048073823738016144056504959939");
    edwards181_Fq3::Frobenius_coeffs_c2[0] = edwards181_Fq("1");
    edwards181_Fq3::Frobenius_coeffs_c2[1] = edwards181_Fq("5136291436651207728317994048073823738016144056504959939");
    edwards181_Fq3::Frobenius_coeffs_c2[2] = edwards181_Fq("1073752683758513276629212192812154536507607213288832061");

    /* parameters for Fq6 */

    edwards181_Fq6::euler = bigint<6*edwards181_q_limbs>("28677290690020897805365935843851174495046307392705069144101373373330885210311370318733027669285930295433693090881034720818190496854917686657535109348176830861059800012474722471292022005286908893541416599742789523143737959708214461870605874121090272322517073698670457333498341250241297120220551099521678676677016084977733861376000");
    edwards181_Fq6::s = 32;
    edwards181_Fq6::t = bigint<6*edwards181_q_limbs>("13353904099213377481962524281745392128381089955896637003916023938605042738053654468959675947803040172641022638828044161581523016493263508499383511649527042573811393236962483483968312854546545489477653335660132357451942730559136002264267706368626222164610900775841650242683636606783278808100405661166495958658408413165125");
    edwards181_Fq6::t_minus_1_over_2 = bigint<6*edwards181_q_limbs>("6676952049606688740981262140872696064190544977948318501958011969302521369026827234479837973901520086320511319414022080790761508246631754249691755824763521286905696618481241741984156427273272744738826667830066178725971365279568001132133853184313111082305450387920825121341818303391639404050202830583247979329204206582562");
    edwards181_Fq6::non_residue = edwards181_Fq("61");
    edwards181_Fq6::nqr = edwards181_Fq6(edwards181_Fq3(edwards181_Fq("5"),edwards181_Fq("0"),edwards181_Fq("0")),edwards181_Fq3::one());
    edwards181_Fq6::nqr_to_t = edwards181_Fq6(edwards181_Fq3::zero(),edwards181_Fq3(edwards181_Fq("0"),edwards181_Fq("6018622460271751604575462891699668290753365582464183006"),edwards181_Fq("0")));
    edwards181_Fq6::Frobenius_coeffs_c1[0] = edwards181_Fq("1");
    edwards181_Fq6::Frobenius_coeffs_c1[1] = edwards181_Fq("1073752683758513276629212192812154536507607213288832062");
    edwards181_Fq6::Frobenius_coeffs_c1[2] = edwards181_Fq("1073752683758513276629212192812154536507607213288832061");
    edwards181_Fq6::Frobenius_coeffs_c1[3] = edwards181_Fq("6210044120409721004947206240885978274523751269793792000");
    edwards181_Fq6::Frobenius_coeffs_c1[4] = edwards181_Fq("5136291436651207728317994048073823738016144056504959939");
    edwards181_Fq6::Frobenius_coeffs_c1[5] = edwards181_Fq("5136291436651207728317994048073823738016144056504959940");
    edwards181_Fq6::my_Fp2::non_residue = edwards181_Fq3::non_residue;
}

} // namespace libff
